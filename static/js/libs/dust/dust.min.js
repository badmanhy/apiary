//
// Dust - Asynchronous Templating v1.1.1
// http://akdubya.github.com/dustjs
//
// Copyright (c) 2010, Aleksander Williams
// Released under the MIT License.
var dust={};function getGlobal(){return function(){return this.dust}.call(null)}
(function(e){function h(a,g,d){this.stack=a;this.global=g;this.blocks=d}function v(a,g,d,j){this.tail=g;this.isObject=!e.isArray(a)&&a&&"object"===typeof a;this.head=a;this.index=d;this.of=j}function w(a){this.head=new n(this);this.callback=a;this.out=""}function j(){this.head=new n(this)}function n(a,g,d){this.root=a;this.next=g;this.data="";this.flushable=!1;this.taps=d}function a(a,g){this.head=a;this.tail=g}e.cache={};e.register=function(a,g){a&&(e.cache[a]=g)};e.render=function(a,g,d){d=(new w(d)).head;
e.load(a,d,h.wrap(g)).end()};e.stream=function(a,g){var d=new j;e.nextTick(function(){e.load(a,d.head,h.wrap(g)).end()});return d};e.renderSource=function(a,g,d){return e.compileFn(a)(g,d)};e.compileFn=function(a,g){var d=e.loadSource(e.compile(a,g));return function(a,g){var M=g?new w(g):new j;e.nextTick(function(){d(M.head,h.wrap(a)).end()});return M}};e.load=function(a,g,d){var j=e.cache[a];return j?j(g,d):e.onLoad?g.map(function(g){e.onLoad(a,function(j,D){if(j)return g.setError(j);e.cache[a]||
e.loadSource(e.compile(D,a));e.cache[a](g,d).end()})}):g.setError(Error("Template Not Found: "+a))};e.loadSource=function(a){return eval(a)};e.isArray=Array.isArray?Array.isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)};var l;l="undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)};e.nextTick=l;e.isEmpty=function(a){return e.isArray(a)&&!a.length?!0:0===a?!1:!a};e.filter=function(a,g,d){if(d)for(var j=0,l=d.length;j<l;j++){var y=d[j];"s"===y?g=null:
"function"===typeof e.filters[y]&&(a=e.filters[y](a))}g&&(a=e.filters[g](a));return a};e.filters={h:function(a){return e.escapeHtml(a)},j:function(a){return e.escapeJs(a)},u:encodeURI,uc:encodeURIComponent,js:function(a){return!JSON?a:JSON.stringify(a)},jp:function(a){return!JSON?a:JSON.parse(a)}};e.makeBase=function(a){return new h(new v,a)};h.wrap=function(a){return a instanceof h?a:new h(new v(a))};h.prototype.get=function(a){for(var g=this.stack,d;g;){if(g.isObject&&(d=g.head[a],void 0!==d))return d;
g=g.tail}return this.global?this.global[a]:void 0};h.prototype.getPath=function(a,g){var d=this.stack,j=g.length;if(a&&0===j)return d.head;for(var d=d.head,e=0;d&&e<j;)d=d[g[e]],e++;return d};h.prototype.push=function(a,g,d){return new h(new v(a,this.stack,g,d),this.global,this.blocks)};h.prototype.rebase=function(a){return new h(new v(a),this.global,this.blocks)};h.prototype.current=function(){return this.stack.head};h.prototype.getBlock=function(a,g,d){"function"===typeof a&&(a=a(g,d).data,g.data=
"");if(g=this.blocks){d=g.length;for(var j;d--;)if(j=g[d][a])return j}};h.prototype.shiftBlocks=function(a){var g=this.blocks;return a?(a=g?g.concat([a]):[a],new h(this.stack,this.global,a)):this};w.prototype.flush=function(){for(var a=this.head;a;){if(a.flushable)this.out+=a.data;else{a.error&&(this.callback(a.error),this.flush=function(){});return}this.head=a=a.next}this.callback(null,this.out)};j.prototype.flush=function(){for(var a=this.head;a;){if(a.flushable)this.emit("data",a.data);else{a.error&&
(this.emit("error",a.error),this.flush=function(){});return}this.head=a=a.next}this.emit("end")};j.prototype.emit=function(a,g){if(!this.events)return!1;var d=this.events[a];if(!d)return!1;if("function"==typeof d)d(g);else for(var d=d.slice(0),j=0,e=d.length;j<e;j++)d[j](g)};j.prototype.on=function(a,g){this.events||(this.events={});this.events[a]?"function"===typeof this.events[a]?this.events[a]=[this.events[a],g]:this.events[a].push(g):this.events[a]=g;return this};j.prototype.pipe=function(a){this.on("data",
function(g){a.write(g,"utf8")}).on("end",function(){a.end()}).on("error",function(g){a.error(g)});return this};n.prototype.write=function(a){var g=this.taps;g&&(a=g.go(a));this.data+=a;return this};n.prototype.end=function(a){a&&this.write(a);this.flushable=!0;this.root.flush();return this};n.prototype.map=function(a){var g=new n(this.root,this.next,this.taps),d=new n(this.root,g,this.taps);this.next=d;this.flushable=!0;a(d);return g};n.prototype.tap=function(g){var d=this.taps;this.taps=d?d.push(g):
new a(g);return this};n.prototype.untap=function(){this.taps=this.taps.tail;return this};n.prototype.render=function(a,g){return a(this,g)};n.prototype.reference=function(a,g,d,j){return"function"===typeof a&&(a.isFunction=!0,a=a.apply(g.current(),[this,g,null,{auto:d,filters:j}]),a instanceof n)?a:e.isEmpty(a)?this:this.write(e.filter(a,d,j))};n.prototype.section=function(a,g,d,j){if("function"===typeof a&&(a=a.apply(g.current(),[this,g,d,j]),a instanceof n))return a;var l=d.block;d=d["else"];j&&
(g=g.push(j));if(e.isArray(a)){if(l){j=a.length;var y=this;if(0<j){g.stack.head&&(g.stack.head.$len=j);for(d=0;d<j;d++)g.stack.head&&(g.stack.head.$idx=d),y=l(y,g.push(a[d],d,j));g.stack.head&&(g.stack.head.$idx=void 0,g.stack.head.$len=void 0);return y}if(d)return d(this,g)}}else if(!0===a){if(l)return l(this,g)}else if(a||0===a){if(l)return g.stack.head&&"object"===typeof a&&(g.stack.head.$idx=0,g.stack.head.$len=1),y=l(this,g.push(a)),g.stack.head&&"object"===typeof a&&(g.stack.head.$idx=void 0,
g.stack.head.$len=void 0),y}else if(d)return d(this,g);return this};n.prototype.exists=function(a,g,d){var j=d.block;d=d["else"];if(e.isEmpty(a)){if(d)return d(this,g)}else if(j)return j(this,g);return this};n.prototype.notexists=function(a,g,d){var j=d.block;d=d["else"];if(e.isEmpty(a)){if(j)return j(this,g)}else if(d)return d(this,g);return this};n.prototype.block=function(a,g,d){d=d.block;a&&(d=a);return d?d(this,g):this};n.prototype.partial=function(a,g,d){var j;d?(j=e.makeBase(g.global),j.blocks=
g.blocks,g.stack&&g.stack.tail&&(j.stack=g.stack.tail),j=j.push(d),j=j.push(g.stack.head)):j=g;return"function"===typeof a?this.capture(a,j,function(a,g){e.load(a,g,j).end()}):e.load(a,this,j)};n.prototype.helper=function(a,g,d,j){if(e.helpers[a])return e.helpers[a](this,g,d,j)};n.prototype.capture=function(a,g,d){return this.map(function(j){var e=new w(function(a,g){a?j.setError(a):d(g,j)});a(e.head,g).end()})};n.prototype.setError=function(a){this.error=a;this.root.flush();return this};a.prototype.push=
function(g){return new a(g,this)};a.prototype.go=function(a){for(var g=this;g;)a=g.head(a),g=g.tail;return a};var g=RegExp(/[&<>\"\']/),d=/&/g,da=/</g,y=/>/g,N=/\"/g,S=/\'/g;e.escapeHtml=function(a){return"string"===typeof a?!g.test(a)?a:a.replace(d,"&amp;").replace(da,"&lt;").replace(y,"&gt;").replace(N,"&quot;").replace(S,"&#39;"):a};var t=/\\/g,x=/\r/g,T=/\u2028/g,I=/\u2029/g,E=/\n/g,J=/\f/g,F=/'/g,s=/"/g,O=/\t/g;e.escapeJs=function(a){return"string"===typeof a?a.replace(t,"\\\\").replace(s,'\\"').replace(F,
"\\'").replace(x,"\\r").replace(T,"\\u2028").replace(I,"\\u2029").replace(E,"\\n").replace(J,"\\f").replace(O,"\\t"):a}})(dust);"undefined"!==typeof exports&&("undefined"!==typeof process&&require("./server")(dust),module.exports=dust);
(function(e){function h(a,d){for(var j=[d[0]],l=1,n=d.length;l<n;l++){var h=e.filterNode(a,d[l]);h&&j.push(h)}return j}function v(a,d){return d}function w(){}function j(a,d){for(var j="",l=1,n=d.length;l<n;l++)j+=e.compileNode(a,d[l]);return j}function n(a,d,j){return"."+j+"("+e.compileNode(a,d[1])+","+e.compileNode(a,d[2])+","+e.compileNode(a,d[4])+","+e.compileNode(a,d[3])+")"}e.compile=function(a,d,j){try{j&&(a=a.replace(/^\s+/mg,"").replace(/\n/mg,""));var l,n=e.parse(a);l=e.filterNode({},n);
a={name:d,bodies:[],blocks:{},index:0,auto:"h"};var h="(function(){dust.register("+(d?'"'+d+'"':"null")+","+e.compileNode(a,l)+");",t;d=[];var x=a.blocks,v;for(v in x)d.push("'"+v+"':"+x[v]);d.length?(a.blocks="ctx=ctx.shiftBlocks(blocks);",t="var blocks={"+d.join(",")+"};"):t=a.blocks="";var h=h+t,w;t=[];for(var E=a.bodies,J=a.blocks,x=0,F=E.length;x<F;x++)t[x]="function body_"+x+"(chk,ctx){"+J+"return chk"+E[x]+";}";w=t.join("");return h+w+"return body_0;})();"}catch(s){if(!s.line||!s.column)throw s;
throw new SyntaxError(s.message+" At line : "+s.line+", column : "+s.column);}};e.filterNode=function(a,d){return e.optimizers[d[0]](a,d)};e.optimizers={body:function(a,d){for(var j=[d[0]],l,n=1,h=d.length;n<h;n++){var t=e.filterNode(a,d[n]);t&&("buffer"===t[0]?l?l[1]+=t[1]:(l=t,j.push(t)):(l=null,j.push(t)))}return j},buffer:v,special:function(g,d){return["buffer",a[d[1]]]},format:w,reference:h,"#":h,"?":h,"^":h,"<":h,"+":h,"@":h,"%":h,partial:h,context:h,params:h,bodies:h,param:h,filters:v,key:v,
path:v,literal:v,comment:w};e.pragmas={esc:function(a,d,e){var l=a.auto;d||(d="h");a.auto="s"===d?"":d;d=j(a,e.block);a.auto=l;return d}};var a={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};e.compileNode=function(a,d){return e.nodes[d[0]](a,d)};e.nodes={body:function(a,d){var e=a.index++,l="body_"+e;a.bodies[e]=j(a,d);return l},buffer:function(a,d){return".write("+l(d[1])+")"},format:function(a,d){return".write("+l(d[1]+d[2])+")"},reference:function(a,d){return".reference("+e.compileNode(a,d[1])+",ctx,"+e.compileNode(a,
d[2])+")"},"#":function(a,d){return n(a,d,"section")},"?":function(a,d){return n(a,d,"exists")},"^":function(a,d){return n(a,d,"notexists")},"<":function(a,d){for(var j=d[4],l=1,n=j.length;l<n;l++){var h=j[l];if("block"===h[1][1]){a.blocks[d[1].text]=e.compileNode(a,h[2]);break}}return""},"+":function(a,d){return"undefined"===typeof d[1].text&&"undefined"===typeof d[4]?".block(ctx.getBlock("+e.compileNode(a,d[1])+",chk, ctx),"+e.compileNode(a,d[2])+", {},"+e.compileNode(a,d[3])+")":".block(ctx.getBlock("+
l(d[1].text)+"),"+e.compileNode(a,d[2])+","+e.compileNode(a,d[4])+","+e.compileNode(a,d[3])+")"},"@":function(a,d){return".helper("+l(d[1].text)+","+e.compileNode(a,d[2])+","+e.compileNode(a,d[4])+","+e.compileNode(a,d[3])+")"},"%":function(a,d){var j=d[1][1];if(!e.pragmas[j])return"";for(var l=d[4],n={},h=1,t=l.length;h<t;h++){var x=l[h];n[x[1][1]]=x[2]}l=d[3];x={};h=1;for(t=l.length;h<t;h++){var v=l[h];x[v[1][1]]=v[2][1]}return e.pragmas[j](a,d[2][1]?d[2][1].text:null,n,x)},partial:function(a,d){return".partial("+
e.compileNode(a,d[1])+","+e.compileNode(a,d[2])+","+e.compileNode(a,d[3])+")"},context:function(a,d){return d[1]?"ctx.rebase("+e.compileNode(a,d[1])+")":"ctx"},params:function(a,d){for(var j=[],l=1,h=d.length;l<h;l++)j.push(e.compileNode(a,d[l]));return j.length?"{"+j.join(",")+"}":"null"},bodies:function(a,d){for(var j=[],l=1,h=d.length;l<h;l++)j.push(e.compileNode(a,d[l]));return"{"+j.join(",")+"}"},param:function(a,d){return e.compileNode(a,d[1])+":"+e.compileNode(a,d[2])},filters:function(a,d){for(var j=
[],l=1,e=d.length;l<e;l++)j.push('"'+d[l]+'"');return'"'+a.auto+'"'+(j.length?",["+j.join(",")+"]":"")},key:function(a,d){return'ctx.get("'+d[1]+'")'},path:function(a,d){for(var j=d[1],l=d[2],h=[],n=0,t=l.length;n<t;n++)Array.isArray(l[n])?h.push(e.compileNode(a,l[n])):h.push('"'+l[n]+'"');return"ctx.getPath("+j+",["+h.join(",")+"])"},literal:function(a,d){return l(d[1])}};var l="undefined"===typeof JSON?function(a){return'"'+e.escapeJs(a)+'"'}:JSON.stringify})("undefined"!==typeof exports?exports:
getGlobal());
(function(e){var h,v=function(j){return'"'+j.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'},w={parse:function(j,e){function a(a){var c={},q;for(q in a)c[q]=a[q];return c}function l(a,c){for(var q=a.offset+c,d=a.offset;d<q;d++){var g=j.charAt(d);"\n"===g?(a.seenCR||a.line++,a.column=1,a.seenCR=!1):"\r"===g||"\u2028"===g||"\u2029"===g?(a.line++,
a.column=1,a.seenCR=!0):(a.column++,a.seenCR=!1)}a.offset+=c}function g(b){c.offset<L.offset||(c.offset>L.offset&&(L=a(c),V=[]),V.push(b))}function d(){var b,f,q;q=a(c);b=[];for(f=w();null!==f;)b.push(f),f=w();null!==b&&(b=["body"].concat(b));null===b&&(c=a(q));return b}function w(){var a;a=U();null===a&&(a=y(),null===a&&(a=E(),null===a&&(a=F(),null===a&&(a=I(),null===a&&(a=$())))));return a}function y(){var b,f,q,K,e,m,r,p,h;k++;p=a(c);h=a(c);b=N();if(null!==b){f=[];for(q=u();null!==q;)f.push(q),
q=u();null!==f?(q=A(),null!==q?(K=d(),null!==K?(e=T(),null!==e?(m=S(),null!==m?(r=b[1].text===m.text?"":null,null!==r?b=[b,f,q,K,e,m,r]:(b=null,c=a(h))):(b=null,c=a(h))):(b=null,c=a(h))):(b=null,c=a(h))):(b=null,c=a(h))):(b=null,c=a(h))}else b=null,c=a(h);null!==b&&(f=b[0],q=b[4],q.push(["param",["literal","block"],b[3]]),f.push(q),b=f);null===b&&(c=a(p));if(null===b){p=a(c);h=a(c);b=N();if(null!==b){f=[];for(q=u();null!==q;)f.push(q),q=u();null!==f?(47===j.charCodeAt(c.offset)?(q="/",l(c,1)):(q=
null,0===k&&g('"/"')),null!==q?(K=A(),null!==K?b=[b,f,q,K]:(b=null,c=a(h))):(b=null,c=a(h))):(b=null,c=a(h))}else b=null,c=a(h);null!==b&&(b=b[0],b.push(["bodies"]));null===b&&(c=a(p))}k--;0===k&&null===b&&g("section");return b}function N(){var b,f,q,d,e,m,h,p;h=a(c);p=a(c);b=B();if(null!==b)if(/^[#?^<+@%]/.test(j.charAt(c.offset))?(f=j.charAt(c.offset),l(c,1)):(f=null,0===k&&g("[#?^<+@%]")),null!==f){q=[];for(d=u();null!==d;)q.push(d),d=u();null!==q?(d=s(),null!==d?(e=t(),null!==e?(m=x(),null!==
m?b=[b,f,q,d,e,m]:(b=null,c=a(p))):(b=null,c=a(p))):(b=null,c=a(p))):(b=null,c=a(p))}else b=null,c=a(p);else b=null,c=a(p);null!==b&&(b=[b[1],b[3],b[4],b[5]]);null===b&&(c=a(h));return b}function S(){var b,f,q,d,e,m,h,p;k++;h=a(c);p=a(c);b=B();if(null!==b)if(47===j.charCodeAt(c.offset)?(f="/",l(c,1)):(f=null,0===k&&g('"/"')),null!==f){q=[];for(d=u();null!==d;)q.push(d),d=u();if(null!==q)if(d=s(),null!==d){e=[];for(m=u();null!==m;)e.push(m),m=u();null!==e?(m=A(),null!==m?b=[b,f,q,d,e,m]:(b=null,c=
a(p))):(b=null,c=a(p))}else b=null,c=a(p);else b=null,c=a(p)}else b=null,c=a(p);else b=null,c=a(p);null!==b&&(b=b[3]);null===b&&(c=a(h));k--;0===k&&null===b&&g("end tag");return b}function t(){var b,f,q,d,e;q=a(c);d=a(c);e=a(c);58===j.charCodeAt(c.offset)?(b=":",l(c,1)):(b=null,0===k&&g('":"'));null!==b?(f=s(),null!==f?b=[b,f]:(b=null,c=a(e))):(b=null,c=a(e));null!==b&&(b=b[1]);null===b&&(c=a(d));b=null!==b?b:"";null!==b&&(b=b?["context",b]:["context"]);null===b&&(c=a(q));return b}function x(){var b,
f,q,d,e,m,h,p;k++;m=a(c);b=[];h=a(c);p=a(c);q=u();if(null!==q)for(f=[];null!==q;)f.push(q),q=u();else f=null;null!==f?(q=z(),null!==q?(61===j.charCodeAt(c.offset)?(d="=",l(c,1)):(d=null,0===k&&g('"="')),null!==d?(e=O(),null===e&&(e=s(),null===e&&(e=R())),null!==e?f=[f,q,d,e]:(f=null,c=a(p))):(f=null,c=a(p))):(f=null,c=a(p))):(f=null,c=a(p));null!==f&&(f=["param",["literal",f[1]],f[3]]);for(null===f&&(c=a(h));null!==f;){b.push(f);h=a(c);p=a(c);q=u();if(null!==q)for(f=[];null!==q;)f.push(q),q=u();else f=
null;null!==f?(q=z(),null!==q?(61===j.charCodeAt(c.offset)?(d="=",l(c,1)):(d=null,0===k&&g('"="')),null!==d?(e=O(),null===e&&(e=s(),null===e&&(e=R())),null!==e?f=[f,q,d,e]:(f=null,c=a(p))):(f=null,c=a(p))):(f=null,c=a(p))):(f=null,c=a(p));null!==f&&(f=["param",["literal",f[1]],f[3]]);null===f&&(c=a(h))}null!==b&&(b=["params"].concat(b));null===b&&(c=a(m));k--;0===k&&null===b&&g("params");return b}function T(){var b,f,q,e,h,m,r,p,n;k++;r=a(c);b=[];p=a(c);n=a(c);f=B();null!==f?(58===j.charCodeAt(c.offset)?
(q=":",l(c,1)):(q=null,0===k&&g('":"')),null!==q?(e=z(),null!==e?(h=A(),null!==h?(m=d(),null!==m?f=[f,q,e,h,m]:(f=null,c=a(n))):(f=null,c=a(n))):(f=null,c=a(n))):(f=null,c=a(n))):(f=null,c=a(n));null!==f&&(f=["param",["literal",f[2]],f[4]]);for(null===f&&(c=a(p));null!==f;)b.push(f),p=a(c),n=a(c),f=B(),null!==f?(58===j.charCodeAt(c.offset)?(q=":",l(c,1)):(q=null,0===k&&g('":"')),null!==q?(e=z(),null!==e?(h=A(),null!==h?(m=d(),null!==m?f=[f,q,e,h,m]:(f=null,c=a(n))):(f=null,c=a(n))):(f=null,c=a(n))):
(f=null,c=a(n))):(f=null,c=a(n)),null!==f&&(f=["param",["literal",f[2]],f[4]]),null===f&&(c=a(p));null!==b&&(b=["bodies"].concat(b));null===b&&(c=a(r));k--;0===k&&null===b&&g("bodies");return b}function I(){var b,f,d,j,e,l;k++;e=a(c);l=a(c);b=B();null!==b?(f=s(),null!==f?(d=J(),null!==d?(j=A(),null!==j?b=[b,f,d,j]:(b=null,c=a(l))):(b=null,c=a(l))):(b=null,c=a(l))):(b=null,c=a(l));null!==b&&(b=["reference",b[1],b[2]]);null===b&&(c=a(e));k--;0===k&&null===b&&g("reference");return b}function E(){var b,
f,d,e,h,m,n,p,v,w,s;k++;w=a(c);s=a(c);b=B();if(null!==b)if(62===j.charCodeAt(c.offset)?(f=">",l(c,1)):(f=null,0===k&&g('">"')),null===f&&(43===j.charCodeAt(c.offset)?(f="+",l(c,1)):(f=null,0===k&&g('"+"'))),null!==f){d=[];for(e=u();null!==e;)d.push(e),e=u();if(null!==d)if(h=a(c),e=z(),null!==e&&(e=["literal",e]),null===e&&(c=a(h)),null===e&&(e=R()),null!==e)if(h=t(),null!==h)if(m=x(),null!==m){n=[];for(p=u();null!==p;)n.push(p),p=u();null!==n?(47===j.charCodeAt(c.offset)?(p="/",l(c,1)):(p=null,0===
k&&g('"/"')),null!==p?(v=A(),null!==v?b=[b,f,d,e,h,m,n,p,v]:(b=null,c=a(s))):(b=null,c=a(s))):(b=null,c=a(s))}else b=null,c=a(s);else b=null,c=a(s);else b=null,c=a(s);else b=null,c=a(s)}else b=null,c=a(s);else b=null,c=a(s);null!==b&&(b=[">"===b[1]?"partial":b[1],b[3],b[4],b[5]]);null===b&&(c=a(w));k--;0===k&&null===b&&g("partial");return b}function J(){var b,f,d,e,h,m;k++;e=a(c);b=[];h=a(c);m=a(c);124===j.charCodeAt(c.offset)?(f="|",l(c,1)):(f=null,0===k&&g('"|"'));null!==f?(d=z(),null!==d?f=[f,
d]:(f=null,c=a(m))):(f=null,c=a(m));null!==f&&(f=f[1]);for(null===f&&(c=a(h));null!==f;)b.push(f),h=a(c),m=a(c),124===j.charCodeAt(c.offset)?(f="|",l(c,1)):(f=null,0===k&&g('"|"')),null!==f?(d=z(),null!==d?f=[f,d]:(f=null,c=a(m))):(f=null,c=a(m)),null!==f&&(f=f[1]),null===f&&(c=a(h));null!==b&&(b=["filters"].concat(b));null===b&&(c=a(e));k--;0===k&&null===b&&g("filters");return b}function F(){var b,f,d,e,h,m;k++;h=a(c);m=a(c);b=B();null!==b?(126===j.charCodeAt(c.offset)?(f="~",l(c,1)):(f=null,0===
k&&g('"~"')),null!==f?(d=z(),null!==d?(e=A(),null!==e?b=[b,f,d,e]:(b=null,c=a(m))):(b=null,c=a(m))):(b=null,c=a(m))):(b=null,c=a(m));null!==b&&(b=["special",b[2]]);null===b&&(c=a(h));k--;0===k&&null===b&&g("special");return b}function s(){var b,f;k++;f=a(c);b=Z();if(null!==b){var d=["path"].concat(b);d.text=b[1].join(".");b=d}null===b&&(c=a(f));null===b&&(f=a(c),b=z(),null!==b&&(d=["key",b],d.text=b,b=d),null===b&&(c=a(f)));k--;0===k&&null===b&&g("identifier");return b}function O(){var b,f;k++;f=
a(c);b=M();null===b&&(b=D());null!==b&&(b=["literal",b]);null===b&&(c=a(f));k--;0===k&&null===b&&g("number");return b}function M(){var b,f,d,e,h,m;k++;h=a(c);m=a(c);b=D();if(null!==b)if(46===j.charCodeAt(c.offset)?(f=".",l(c,1)):(f=null,0===k&&g('"."')),null!==f){e=D();if(null!==e)for(d=[];null!==e;)d.push(e),e=D();else d=null;null!==d?b=[b,f,d]:(b=null,c=a(m))}else b=null,c=a(m);else b=null,c=a(m);null!==b&&(b=parseFloat(b[0]+"."+b[2].join("")));null===b&&(c=a(h));k--;0===k&&null===b&&g("frac");
return b}function D(){var b,f,d;k++;d=a(c);/^[0-9]/.test(j.charAt(c.offset))?(f=j.charAt(c.offset),l(c,1)):(f=null,0===k&&g("[0-9]"));if(null!==f)for(b=[];null!==f;)b.push(f),/^[0-9]/.test(j.charAt(c.offset))?(f=j.charAt(c.offset),l(c,1)):(f=null,0===k&&g("[0-9]"));else b=null;null!==b&&(b=parseInt(b.join(""),10));null===b&&(c=a(d));k--;0===k&&null===b&&g("integer");return b}function Z(){var b,f,d,e,h;k++;e=a(c);h=a(c);b=z();b=null!==b?b:"";if(null!==b){d=H();null===d&&(d=G());if(null!==d)for(f=[];null!==
d;)f.push(d),d=H(),null===d&&(d=G());else f=null;null!==f?b=[b,f]:(b=null,c=a(h))}else b=null,c=a(h);null!==b&&(f=b[0],b=b[1],b=b[0],f&&b?(b.unshift(f),b=[!1,b]):b=[!0,b]);null===b&&(c=a(e));if(null===b){e=a(c);h=a(c);46===j.charCodeAt(c.offset)?(b=".",l(c,1)):(b=null,0===k&&g('"."'));if(null!==b){f=[];d=H();for(null===d&&(d=G());null!==d;)f.push(d),d=H(),null===d&&(d=G());null!==f?b=[b,f]:(b=null,c=a(h))}else b=null,c=a(h);null!==b&&(b=0<b[1].length?[!0,b[1][0]]:[!0,[]]);null===b&&(c=a(e))}k--;0===
k&&null===b&&g("path");return b}function z(){var b,f,d,e,h;k++;e=a(c);h=a(c);/^[a-zA-Z_$]/.test(j.charAt(c.offset))?(b=j.charAt(c.offset),l(c,1)):(b=null,0===k&&g("[a-zA-Z_$]"));if(null!==b){f=[];/^[0-9a-zA-Z_$\-]/.test(j.charAt(c.offset))?(d=j.charAt(c.offset),l(c,1)):(d=null,0===k&&g("[0-9a-zA-Z_$\\-]"));for(;null!==d;)f.push(d),/^[0-9a-zA-Z_$\-]/.test(j.charAt(c.offset))?(d=j.charAt(c.offset),l(c,1)):(d=null,0===k&&g("[0-9a-zA-Z_$\\-]"));null!==f?b=[b,f]:(b=null,c=a(h))}else b=null,c=a(h);null!==
b&&(b=b[0]+b[1].join(""));null===b&&(c=a(e));k--;0===k&&null===b&&g("key");return b}function G(){var b,f,d,e,h,m,n,p;k++;e=a(c);h=a(c);m=a(c);n=a(c);b=aa();if(null!==b){p=a(c);/^[0-9]/.test(j.charAt(c.offset))?(d=j.charAt(c.offset),l(c,1)):(d=null,0===k&&g("[0-9]"));if(null!==d)for(f=[];null!==d;)f.push(d),/^[0-9]/.test(j.charAt(c.offset))?(d=j.charAt(c.offset),l(c,1)):(d=null,0===k&&g("[0-9]"));else f=null;null!==f&&(f=f.join(""));null===f&&(c=a(p));null===f&&(f=s());null!==f?(d=ba(),null!==d?b=
[b,f,d]:(b=null,c=a(n))):(b=null,c=a(n))}else b=null,c=a(n);null!==b&&(b=b[1]);null===b&&(c=a(m));null!==b?(f=H(),f=null!==f?f:"",null!==f?b=[b,f]:(b=null,c=a(h))):(b=null,c=a(h));null!==b&&(f=b[0],(b=b[1])?b.unshift(f):b=[f]);null===b&&(c=a(e));k--;0===k&&null===b&&g("array");return b}function H(){var b,f,d,e,h,m,n;k++;e=a(c);h=a(c);m=a(c);n=a(c);46===j.charCodeAt(c.offset)?(f=".",l(c,1)):(f=null,0===k&&g('"."'));null!==f?(d=z(),null!==d?f=[f,d]:(f=null,c=a(n))):(f=null,c=a(n));null!==f&&(f=f[1]);
null===f&&(c=a(m));if(null!==f)for(b=[];null!==f;)b.push(f),m=a(c),n=a(c),46===j.charCodeAt(c.offset)?(f=".",l(c,1)):(f=null,0===k&&g('"."')),null!==f?(d=z(),null!==d?f=[f,d]:(f=null,c=a(n))):(f=null,c=a(n)),null!==f&&(f=f[1]),null===f&&(c=a(m));else b=null;null!==b?(f=G(),f=null!==f?f:"",null!==f?b=[b,f]:(b=null,c=a(h))):(b=null,c=a(h));null!==b&&(b=b[1]?b[0].concat(b[1]):b[0]);null===b&&(c=a(e));k--;0===k&&null===b&&g("array_part");return b}function R(){var b,f,d,e,h;k++;e=a(c);h=a(c);34===j.charCodeAt(c.offset)?
(b='"',l(c,1)):(b=null,0===k&&g('"\\""'));null!==b?(34===j.charCodeAt(c.offset)?(f='"',l(c,1)):(f=null,0===k&&g('"\\""')),null!==f?b=[b,f]:(b=null,c=a(h))):(b=null,c=a(h));null!==b&&(b=["literal",""]);null===b&&(c=a(e));if(null===b&&(e=a(c),h=a(c),34===j.charCodeAt(c.offset)?(b='"',l(c,1)):(b=null,0===k&&g('"\\""')),null!==b?(f=W(),null!==f?(34===j.charCodeAt(c.offset)?(d='"',l(c,1)):(d=null,0===k&&g('"\\""')),null!==d?b=[b,f,d]:(b=null,c=a(h))):(b=null,c=a(h))):(b=null,c=a(h)),null!==b&&(b=["literal",
b[1]]),null===b&&(c=a(e)),null===b)){e=a(c);h=a(c);34===j.charCodeAt(c.offset)?(b='"',l(c,1)):(b=null,0===k&&g('"\\""'));if(null!==b){d=X();if(null!==d)for(f=[];null!==d;)f.push(d),d=X();else f=null;null!==f?(34===j.charCodeAt(c.offset)?(d='"',l(c,1)):(d=null,0===k&&g('"\\""')),null!==d?b=[b,f,d]:(b=null,c=a(h))):(b=null,c=a(h))}else b=null,c=a(h);null!==b&&(b=["body"].concat(b[1]));null===b&&(c=a(e))}k--;0===k&&null===b&&g("inline");return b}function X(){var b,d;b=F();null===b&&(b=I(),null===b&&
(d=a(c),b=W(),null!==b&&(b=["buffer",b]),null===b&&(c=a(d))));return b}function $(){var b,d,e,h,n,m,r;k++;n=a(c);m=a(c);b=P();if(null!==b){d=[];for(e=u();null!==e;)d.push(e),e=u();null!==d?b=[b,d]:(b=null,c=a(m))}else b=null,c=a(m);null!==b&&(b=["format",b[0],b[1].join("")]);null===b&&(c=a(n));if(null===b){n=a(c);m=a(c);r=a(c);h=a(c);k++;d=Q();k--;null===d?d="":(d=null,c=a(h));null!==d?(h=a(c),k++,e=U(),k--,null===e?e="":(e=null,c=a(h)),null!==e?(j.length>c.offset?(h=j.charAt(c.offset),l(c,1)):(h=
null,0===k&&g("any character")),null!==h?d=[d,e,h]:(d=null,c=a(r))):(d=null,c=a(r))):(d=null,c=a(r));null!==d&&(d=d[2]);null===d&&(c=a(m));if(null!==d)for(b=[];null!==d;)b.push(d),m=a(c),r=a(c),h=a(c),k++,d=Q(),k--,null===d?d="":(d=null,c=a(h)),null!==d?(h=a(c),k++,e=U(),k--,null===e?e="":(e=null,c=a(h)),null!==e?(j.length>c.offset?(h=j.charAt(c.offset),l(c,1)):(h=null,0===k&&g("any character")),null!==h?d=[d,e,h]:(d=null,c=a(r))):(d=null,c=a(r))):(d=null,c=a(r)),null!==d&&(d=d[2]),null===d&&(c=a(m));
else b=null;null!==b&&(b=["buffer",b.join("")]);null===b&&(c=a(n))}k--;0===k&&null===b&&g("buffer");return b}function W(){var b,d,e,h,n,m;k++;h=a(c);n=a(c);m=a(c);e=a(c);k++;d=Q();k--;null===d?d="":(d=null,c=a(e));null!==d?(e=Y(),null===e&&(/^[^"]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),l(c,1)):(e=null,0===k&&g('[^"]'))),null!==e?d=[d,e]:(d=null,c=a(m))):(d=null,c=a(m));null!==d&&(d=d[1]);null===d&&(c=a(n));if(null!==d)for(b=[];null!==d;)b.push(d),n=a(c),m=a(c),e=a(c),k++,d=Q(),k--,null===
d?d="":(d=null,c=a(e)),null!==d?(e=Y(),null===e&&(/^[^"]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),l(c,1)):(e=null,0===k&&g('[^"]'))),null!==e?d=[d,e]:(d=null,c=a(m))):(d=null,c=a(m)),null!==d&&(d=d[1]),null===d&&(c=a(n));else b=null;null!==b&&(b=b.join(""));null===b&&(c=a(h));k--;0===k&&null===b&&g("literal");return b}function Y(){var b,d;d=a(c);'\\"'===j.substr(c.offset,2)?(b='\\"',l(c,2)):(b=null,0===k&&g('"\\\\\\""'));null!==b&&(b='"');null===b&&(c=a(d));return b}function U(){var b,d,e,
h,n,m,r,p;k++;n=a(c);m=a(c);"{!"===j.substr(c.offset,2)?(b="{!",l(c,2)):(b=null,0===k&&g('"{!"'));if(null!==b){d=[];r=a(c);p=a(c);h=a(c);k++;"!}"===j.substr(c.offset,2)?(e="!}",l(c,2)):(e=null,0===k&&g('"!}"'));k--;null===e?e="":(e=null,c=a(h));null!==e?(j.length>c.offset?(h=j.charAt(c.offset),l(c,1)):(h=null,0===k&&g("any character")),null!==h?e=[e,h]:(e=null,c=a(p))):(e=null,c=a(p));null!==e&&(e=e[1]);for(null===e&&(c=a(r));null!==e;)d.push(e),r=a(c),p=a(c),h=a(c),k++,"!}"===j.substr(c.offset,2)?
(e="!}",l(c,2)):(e=null,0===k&&g('"!}"')),k--,null===e?e="":(e=null,c=a(h)),null!==e?(j.length>c.offset?(h=j.charAt(c.offset),l(c,1)):(h=null,0===k&&g("any character")),null!==h?e=[e,h]:(e=null,c=a(p))):(e=null,c=a(p)),null!==e&&(e=e[1]),null===e&&(c=a(r));null!==d?("!}"===j.substr(c.offset,2)?(e="!}",l(c,2)):(e=null,0===k&&g('"!}"')),null!==e?b=[b,d,e]:(b=null,c=a(m))):(b=null,c=a(m))}else b=null,c=a(m);null!==b&&(b=["comment",b[1].join("")]);null===b&&(c=a(n));k--;0===k&&null===b&&g("comment");
return b}function Q(){var b,d,e,h,n,m,r,p,s,t;s=a(c);b=B();if(null!==b){d=[];for(e=u();null!==e;)d.push(e),e=u();if(null!==d)if(/^[#?^><+%:@\/~%]/.test(j.charAt(c.offset))?(e=j.charAt(c.offset),l(c,1)):(e=null,0===k&&g("[#?^><+%:@\\/~%]")),null!==e){h=[];for(n=u();null!==n;)h.push(n),n=u();if(null!==h){t=a(c);p=a(c);k++;m=A();k--;null===m?m="":(m=null,c=a(p));null!==m?(p=a(c),k++,r=P(),k--,null===r?r="":(r=null,c=a(p)),null!==r?(j.length>c.offset?(p=j.charAt(c.offset),l(c,1)):(p=null,0===k&&g("any character")),
null!==p?m=[m,r,p]:(m=null,c=a(t))):(m=null,c=a(t))):(m=null,c=a(t));if(null!==m)for(n=[];null!==m;)n.push(m),t=a(c),p=a(c),k++,m=A(),k--,null===m?m="":(m=null,c=a(p)),null!==m?(p=a(c),k++,r=P(),k--,null===r?r="":(r=null,c=a(p)),null!==r?(j.length>c.offset?(p=j.charAt(c.offset),l(c,1)):(p=null,0===k&&g("any character")),null!==p?m=[m,r,p]:(m=null,c=a(t))):(m=null,c=a(t))):(m=null,c=a(t));else n=null;if(null!==n){m=[];for(r=u();null!==r;)m.push(r),r=u();null!==m?(r=A(),null!==r?b=[b,d,e,h,n,m,r]:(b=
null,c=a(s))):(b=null,c=a(s))}else b=null,c=a(s)}else b=null,c=a(s)}else b=null,c=a(s);else b=null,c=a(s)}else b=null,c=a(s);null===b&&(b=I());return b}function B(){var a;123===j.charCodeAt(c.offset)?(a="{",l(c,1)):(a=null,0===k&&g('"{"'));return a}function A(){var a;125===j.charCodeAt(c.offset)?(a="}",l(c,1)):(a=null,0===k&&g('"}"'));return a}function aa(){var a;91===j.charCodeAt(c.offset)?(a="[",l(c,1)):(a=null,0===k&&g('"["'));return a}function ba(){var a;93===j.charCodeAt(c.offset)?(a="]",l(c,
1)):(a=null,0===k&&g('"]"'));return a}function P(){var a;10===j.charCodeAt(c.offset)?(a="\n",l(c,1)):(a=null,0===k&&g('"\\n"'));null===a&&("\r\n"===j.substr(c.offset,2)?(a="\r\n",l(c,2)):(a=null,0===k&&g('"\\r\\n"')),null===a&&(13===j.charCodeAt(c.offset)?(a="\r",l(c,1)):(a=null,0===k&&g('"\\r"')),null===a&&(8232===j.charCodeAt(c.offset)?(a="\u2028",l(c,1)):(a=null,0===k&&g('"\\u2028"')),null===a&&(8233===j.charCodeAt(c.offset)?(a="\u2029",l(c,1)):(a=null,0===k&&g('"\\u2029"'))))));return a}function u(){var a;
/^[\t\x0B\f \xA0\uFEFF]/.test(j.charAt(c.offset))?(a=j.charAt(c.offset),l(c,1)):(a=null,0===k&&g("[\\t\\x0B\\f \\xA0\\uFEFF]"));null===a&&(a=P());return a}function ea(a){a.sort();for(var c=null,d=[],e=0;e<a.length;e++)a[e]!==c&&(d.push(a[e]),c=a[e]);return d}var C={body:d,part:w,section:y,sec_tag_start:N,end_tag:S,context:t,params:x,bodies:T,reference:I,partial:E,filters:J,special:F,identifier:s,number:O,frac:M,integer:D,path:Z,key:z,array:G,array_part:H,inline:R,inline_part:X,buffer:$,literal:W,
esc:Y,comment:U,tag:Q,ld:B,rd:A,lb:aa,rb:ba,eol:P,ws:u};if(void 0!==e){if(void 0===C[e])throw Error("Invalid rule name: "+v(e)+".");}else e="body";var c={offset:0,line:1,column:1,seenCR:!1},k=0,L={offset:0,line:1,column:1,seenCR:!1},V=[],C=C[e]();if(null===C||c.offset!==j.length){var C=Math.max(c.offset,L.offset),fa=C<j.length?j.charAt(C):null,ca=c.offset>L.offset?c:L;throw new h.SyntaxError(ea(V),fa,C,ca.line,ca.column);}return C},toSource:function(){return this._source},SyntaxError:function(e,h,
a,l,g){this.name="SyntaxError";this.expected=e;this.found=h;switch(e.length){case 0:e="end of input";break;case 1:e=e[0];break;default:e=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}h=h?v(h):"end of input";this.message="Expected "+e+" but "+h+" found.";this.offset=a;this.line=l;this.column=g}};w.SyntaxError.prototype=Error.prototype;h=w;e.parse=h.parse})("undefined"!==typeof exports?exports:getGlobal());
